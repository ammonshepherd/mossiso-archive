{"id":1121,"date":"2011-10-17T13:39:00","date_gmt":"2011-10-17T17:39:00","guid":{"rendered":"http:\/\/mossiso.com\/?p=1121"},"modified":"2012-02-23T14:11:46","modified_gmt":"2012-02-23T19:11:46","slug":"centos-6-idrac6-and-poweredge-r510","status":"publish","type":"post","link":"https:\/\/mossiso.com\/2011\/10\/17\/centos-6-idrac6-and-poweredge-r510\/","title":{"rendered":"CentOS 6, iDrac6 and PowerEdge R510"},"content":{"rendered":"<ol>\n<li>RedHat changed an important part of their system with the upgrade from version 5 to 6. This affects CentOS which is the same thing, but rebranded.<\/li>\n<\/ol>\n<p>I was updating one server to use CentOS 6, and ran into this issue of setting up the iDRAC for remote console use. In previous versions, I would add a line to the \/etc\/inittab file. This is now unused. RedHat is favoring the &#8220;Upstart&#8221; system developed by and for Ubuntu. It starts services on request, rather than all at once.<\/p>\n<p>So here is how I set up my Dell PowerEdge R510 with CentOS 6 to use the iDRAC6.<\/p>\n<p>Info was taken from the <a href=\"http:\/\/docs.redhat.com\/docs\/en-US\/Red_Hat_Enterprise_Linux\/6\/html\/Migration_Planning_Guide\/ch04s02.html\" target=\"_blank\">RedHat manual<\/a>, the <a href=\"http:\/\/support.dell.com\/support\/edocs\/software\/smdrac3\/idrac\/idrac11mono\/en\/ug\/html\/racugc3.htm#wp3869\" target=\"_blank\">Dell iDRAC manual<\/a>, and probably a bunch of other <a href=\"http:\/\/tldp.org\/HOWTO\/Remote-Serial-Console-HOWTO\/\" target=\"_blank\">sites<\/a> that I googled for.<\/p>\n<p>These steps are by no means comprehensive or detailed. I barely even know what&#8217;s going on myself, but it seems to work. It&#8217;s kind of cool to see a system boot up in your terminal. It&#8217;s like your terminal turns into a monitor connected to the server.<\/p>\n<p><a href=\"http:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-medium wp-image-1123\" title=\"Screen Shot 2011-10-17 at  Oct 17 1.35.06 PM\" src=\"http:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM-300x215.png\" alt=\"\" width=\"300\" height=\"215\" srcset=\"https:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM-300x215.png 300w, https:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM-250x179.png 250w, https:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM-150x107.png 150w, https:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM-624x448.png 624w, https:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.35.06-PM.png 639w\" sizes=\"(max-width: 300px) 100vw, 300px\" \/><\/a><\/p>\n<h3>Setting up the iDrac6<\/h3>\n<h4>Edit BIOS<\/h4>\n<ol>\n<li>Boot the server.<\/li>\n<li>Press <code>F2<\/code> to enter the BIOS setup utility during POST.<\/li>\n<li>Scroll down and select Serial Communication by pressing <code>&lt;Enter&gt;<\/code>.<\/li>\n<li>Set the Serial Communication screen options as follows:<\/li>\n<ul>\n<li><code>serial communication....On with serial redirection via com2<\/code><\/li>\n<li>NOTE: You can set serial communication to &#8216;On with serial redirection via com1&#8217; as long as the serial port address field, serial device2, is set to com1, also.<\/li>\n<li><code>serial port address....Serial device1 = com1, serial device2 = com2<\/code><\/li>\n<li><code>external serial connector....Serial device 1<\/code><\/li>\n<li><code>failsafe baud rate....57600<\/code><\/li>\n<li><code>remote terminal type....vt100\/vt220<\/code><\/li>\n<li><code>redirection after boot....Enabled<\/code><\/li>\n<\/ul>\n<li>Save the changes and exit.<\/li>\n<\/ol>\n<h4>Edit iDRAC settings<\/h4>\n<ol>\n<li>Turn on or restart your system.<\/li>\n<li>Press <code>&lt;Ctrl&gt;&lt;E&gt;<\/code> when prompted during POST. If your operating system begins to load before you press <code>&lt;Ctrl&gt;&lt;E&gt;<\/code>, allow the system to finish booting, and then restart your system and try again.<\/li>\n<li>Configure the LOM.<\/li>\n<\/ol>\n<ol>\n<li>Use the arrow keys to select LAN Parameters and press <code>&lt;Enter&gt;<\/code>. NIC Selection is displayed.<\/li>\n<li>Use the arrow keys to select one of the following NIC modes:<\/li>\n<ul>\n<li>Dedicated \u2014 Select this option to enable the remote access device to utilize the dedicated network interface available on the iDRAC6 Enterprise. This interface is not shared with the host operating system and routes the management traffic to a separate physical network, enabling it to be separated from the application traffic. This option is available only if an iDRAC6 Enterprise is installed in the system. After you install the iDRAC6 Enterprise card, ensure that you change the NIC Selection to Dedicated. This can be done either through the iDRAC6 Configuration Utility, the iDRAC6 Web Interface, or through RACADM.<\/li>\n<\/ul>\n<\/ol>\n<ul>\n<li>Configure the network controller LAN parameters to use DHCP or a Static IP address source.<\/li>\n<\/ul>\n<ol>\n<li>Using the down-arrow key, select LAN Parameters, and press <code>&lt;Enter&gt;<\/code>.<\/li>\n<li>Using the up-arrow and down-arrow keys, select IP Address Source.<\/li>\n<li>Using the right-arrow and left-arrow keys, select DHCP, Auto Config or Static.<\/li>\n<li>If you selected Static, configure the Ethernet IP Address, Subnet Mask, and Default Gateway settings.<\/li>\n<li>Press <code>&lt;Esc&gt;<\/code>.<\/li>\n<\/ol>\n<ul>\n<li>Press <code>&lt;Esc&gt;<\/code>.<\/li>\n<li>Select Save Changes and Exit.<\/li>\n<\/ul>\n<h4>Set up Linux OS (to do after OS is installed)<\/h4>\n<ul>\n<li>Configuring Linux for Serial Console Redirection During Boot<\/li>\n<li>The following steps are specific to the Linux GRand Unified Bootloader (GRUB). Similar changes would be necessary if you use a different boot loader.<\/li>\n<li><strong>NOTE:<\/strong> When you configure the client VT100 emulation window, set the window or application that is displaying the redirected console to 25 rows x 80 columns to ensure proper text display; otherwise, some text screens may be garbled.<\/li>\n<\/ul>\n<ol>\n<li>Make a copy of the <code>\/boot\/grub\/grub.conf<\/code>file as follows:<code>cp \/boot\/grub\/grub.conf \/boot\/grub\/grub.conf.orig<\/code><\/li>\n<li>Edit the <code>\/boot\/grub\/grub.conf<\/code> file as follows:<\/li>\n<\/ol>\n<ol>\n<li>Locate the General Setting sections in the file and add the following two new lines:<code>serial --unit=0 --speed=57600<\/code><code>terminal --timeout=10 serial console<\/code><\/li>\n<li>Append two options to the kernel line:<code>kernel ............. console=ttyS1,57600 console=tty1<\/code><\/li>\n<li>If the \/etc\/grub.conf contains a splashimage directive, comment it out.Sample File: <code>\/boot\/grub\/grub.conf<\/code>\n<div style=\"border: 1px solid; font-family: 'Courier New', Courier, monospace; color: #444; padding: 8px;\">#\u00a0 grub.conf generated by anaconda<br \/>\n#<br \/>\n#\u00a0 Note that you do not have to rerun grub after making changes to this file<br \/>\n#\u00a0 NOTICE: You have a \/boot partition. This means that<br \/>\n#\u00a0 all kernel and initrd paths are relative to \/boot\/, eg.<br \/>\n#\u00a0 root (hd0,0)<br \/>\n#\u00a0 kernel \/vmlinuz-version ro root=\/dev\/Logical1\/LogVol00<br \/>\n#\u00a0 initrd \/initrd-version.img<br \/>\n#boot=\/dev\/sda<br \/>\ndefault=0<br \/>\ntimeout=5<br \/>\n<strong> #splashimage=(hd0,0)\/grub\/splash.xpm.gz<\/strong><br \/>\n#hiddenmenu<br \/>\n<strong>serial &#8211;unit=1 &#8211;speed=57600<\/strong><br \/>\n<strong>terminal &#8211;timeout=5 console serial<\/strong>title CentOS (2.6.18-164.11.1.el5) SOL Redirection<br \/>\nroot (hd0,0)<br \/>\nkernel \/vmlinuz-2.6.18-164.11.1.el5 ro root=\/dev\/Logical1\/LogVol00 <strong>console=tty1 console=ttyS1,57600<\/strong><br \/>\ninitrd \/initrd-2.6.18-164.11.1.el5.img<br \/>\ntitle CentOS (2.6.18-164.el5)<br \/>\nroot (hd0,0)<br \/>\nkernel \/vmlinuz-2.6.18-164.el5 ro root=\/dev\/Logical1\/LogVol00<br \/>\ninitrd \/initrd-2.6.18-164.el5.img<\/div>\n<\/li>\n<\/ol>\n<h4>Enabling Login to the Console After Boot<\/h4>\n<ol>\n<li>Create a new <code>\/etc\/init\/serial-ttyS1.conf<\/code>file.Sample File: <code>\/etc\/inittab<\/code>\n<div style=\"border: 1px solid; font-family: 'Courier New', Courier, monospace; color: #444; padding: 8px;\">#\u00a0 This service maintains a getty on \/dev\/ttyS1.start on stopped rc RUNLEVEL=[2345]<br \/>\nstop on starting runlevel [016]respawn<br \/>\nexec \/sbin\/agetty -h -L 57600 ttyS1 vt102<\/div>\n<\/li>\n<\/ol>\n<h4>Edit the file <code>\/etc\/securetty<\/code><\/h4>\n<ol>\n<li>Make a copy of the <code>\/etc\/securetty<\/code>file as follows:<code>cp \/etc\/securetty \/etc\/securetty.orig<\/code><\/li>\n<li>Edit the file <code>\/etc\/securetty<\/code>as follows:Add a new line with the name of the serial tty for COM2:<code>ttyS1<\/code>Sample File: <code>\/etc\/securetty<\/code>\n<div style=\"border: 1px solid; font-family: 'Courier New', Courier, monospace; color: #444; padding: 8px;\">vc\/1<br \/>\nvc\/2<br \/>\nvc\/3<br \/>\nvc\/4<br \/>\nvc\/5<br \/>\nvc\/6<br \/>\nvc\/7<br \/>\nvc\/8<br \/>\nvc\/9<br \/>\nvc\/10<br \/>\nvc\/11<br \/>\ntty1<br \/>\ntty2<br \/>\ntty3<br \/>\ntty4<br \/>\ntty5<br \/>\ntty6<br \/>\ntty7<br \/>\ntty8<br \/>\ntty9<br \/>\ntty10<br \/>\ntty11<br \/>\n*ttyS1*<\/div>\n<\/li>\n<\/ol>\n<h2>Redirect the video output over ssh connections<\/h2>\n<h3>Starting a Text Console Through SSH (Remote Access, SOL)<\/h3>\n<p>To connect to the managed system text console, open an iDRAC6 command prompt (displayed through an SSH session):<\/p>\n<p><code>ssh root@xxx.xxx.xxx.xxx<\/code><\/p>\n<p>and type:<\/p>\n<p><code>console com2<\/code><\/p>\n<p>Only one <code>console com2<\/code> client is supported at a time. The <code>console -h com2<\/code> command displays the contents of the serial history buffer before waiting for input from the keyboard or new characters from the serial port.<\/p>\n<p>To exit the console type these three keys: <code><\/code><code>&lt;Ctrl &gt;&lt;Shift &gt;\\<\/code><\/p>\n<p>The default (and maximum) size of the history buffer is 8192 characters. You can set this number to a smaller value using the command:<\/p>\n<p><code>racadm config -g cfgSerial -o cfgSerialHistorySize &lt; number &gt;<\/code><\/p>\n","protected":false},"excerpt":{"rendered":"<p>RedHat changed an important part of their system with the upgrade from version 5 to 6. This affects CentOS which is the same thing, but rebranded. I was updating one server to use CentOS 6, and ran into this issue of setting up the iDRAC for remote console use. In previous versions, I would add &hellip; <a href=\"https:\/\/mossiso.com\/2011\/10\/17\/centos-6-idrac6-and-poweredge-r510\/\" class=\"more-link\">Continue reading <span class=\"screen-reader-text\">CentOS 6, iDrac6 and PowerEdge R510<\/span><\/a><\/p>\n","protected":false},"author":1,"featured_media":1122,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"jetpack_post_was_ever_published":false,"_jetpack_newsletter_access":"","_jetpack_dont_email_post_to_subs":false,"_jetpack_newsletter_tier_id":0,"footnotes":"","jetpack_publicize_message":"","jetpack_publicize_feature_enabled":true,"jetpack_social_post_already_shared":false,"jetpack_social_options":{"image_generator_settings":{"template":"highway","enabled":false}}},"categories":[167],"tags":[222,179,223],"class_list":["post-1121","post","type-post","status-publish","format-standard","has-post-thumbnail","hentry","category-technical","tag-linux","tag-servers","tag-systems-administration"],"jetpack_publicize_connections":[],"jetpack_featured_media_url":"https:\/\/mossiso.com\/wp-content\/uploads\/2011\/10\/Screen-Shot-2011-10-17-at-Oct-17-1.34.40-PM.png","jetpack_sharing_enabled":true,"jetpack_shortlink":"https:\/\/wp.me\/p9wosP-i5","_links":{"self":[{"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/posts\/1121"}],"collection":[{"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/comments?post=1121"}],"version-history":[{"count":7,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/posts\/1121\/revisions"}],"predecessor-version":[{"id":1126,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/posts\/1121\/revisions\/1126"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/media\/1122"}],"wp:attachment":[{"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/media?parent=1121"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/categories?post=1121"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/mossiso.com\/wp-json\/wp\/v2\/tags?post=1121"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}